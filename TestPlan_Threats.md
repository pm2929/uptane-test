# Test Plan - Threats 


| Serial Number        | Threats  | Description | Test Plan |
|:-------------:|:-------------:|:-----|:-------------------|
| 1. | Eavesdrop attack     |    Read sensitive or confidential information from an update intended to be encrypted for a specific ECU| 1. Identify the type of network, to connect to the primary ECU 2. If the attacker is in the network, he uses different techniques depending on the type of network, to start capturing network traffic 3. If the connection is built over WLAN, verify if the wireless access points encrypted. Verify if the network administrators use Wireless Protected Access - or WPA and Wired Equivalent Privacy - or WEP 4. Download a WEP/WAP cracking tool such as Aircrack  5. Use Aircrack to break encryption and connect to the WLAN 6. If the WLAN is protected, it should resist to the cryptographic attack in step 5, making it impossible to follow with the eavesdropping attack 7. If the data transfer is via LTE, verify if the data layer is integrity-protected. This means an attacker can change the bits even within an encrypted packet, and then the attacker will be able to decrypt that packet 8. Verify if the LTE data is encrypted in counter mode (AES-CTR), if yes then update the specification to use an encryption protocol with authentication such as AES-GCM 9. Verify if there are unautorized network monitors sniffing the traffic
| 2.    | Drop-request attack | Block network traffic outside or inside the vehicle  to prevent an ECU from receiving any updates. | 1. Using the above mechanism identify if an attacker is intercepting your traffic 2. If yes, perform the following to verify if the packets delivering to the primary ECU are dropped a. Set an absolute connection timeout, if possible. Of course, if the timeout is too short, you risk dropping legitimate slow connections b. Verify if there is a backlog of pending connections  c. Verify if there is some network congestion d. Verify if there is a malicious node between the ECU and repositories, this leads to suspension of communication or generation of wrong information between the ECU and the repositories |
| 3.   | Slow retrieval attack     |   Slow down network traffic, in the extreme case sending barely enough packets to avoid a timeout. Similar to a drop-request attack, except that both the sender and receiver of the traffic still think network traffic is unimpeded | 1. Verify the timeout for any packets sent from the Image/Director repository to the primary ECU against the standards (to prevent tampering) 2. Verify the timegap between two requests, if its less than the defined standard raise an alert
| 4.     | Freeze attack   |   Continue to send a properly signed, but old, update bundle to the ECUs, even if newer updates exist| Update Process: 1. Assuming supplier delegation is supported by the OEM for this ECU, each tier-1 supplier digitally signs the image, then delivers the signature and all of its metadata, including delegations, and associated images to the OEM. 2. The OEM adds these metadata and images to its image repository, along with information about any dependencies and conflicts between this image and those for other ECUs used in the OEM’s vehicles. 3.  The OEM also updates the inventory database, so that the director repository can instruct the ECU on how to install these updated images. Checks and Balances: 1. Verify if every ECU is periodically (e.g., once between every two ignition cycles) update its current time using an external time server.  2. Verify if every ECU sends a nonce to the primary which, in turn, passes the nonces along to the time server. Then, the time server individually signs for each nonce the current time and nonce, and sends the re- sponse to the primary. 3. The primary verifies this response (ensuring that the signatures are valid, and that the time is the same for every nonce), and sends the current time to secondaries. 4. Verify if dependency resolution is performed to determine the differences between the previous and latest images 5. Verify if the OEM checks whether the delta images match the Targets metadata from the Director repository. 6. Verify if updates are denied installation to prevent vehicles from fixing software problems
| 5.    | Partial bundle installation attack | Install a valid (signed) update bundle, and then block selected updates within the bundle | This a variation to freeze attack, it is also a man-in-the-middle attack, however it restricts the updates from being installed on a few select ECU's. 1. Verify if the primary ECU broadcasts the latest downloaded metadata to secondaries  2. Verify if the OEM can detect these attacks us- ing a vehicle version manifest, or information signed by every ECU about what it has currently installed  3. If the director detects a mismatch between the last updates sent to the ve- hicle compared to what it has actually installed, then the OEM may be alerted about this for further follow-up.
| 6.    | Rollback attack:    |   Cause an ECU to install a previously valid software revision that is older than the currently installed version. | 1. Verify if the director can instruct the ECU to replace its current image on disk with an older version number, as the director role to control updates 2. Verify the access rights to supplier keys are limited , If attackers have compromised a supplier’s keys (as well as the timestamp, release, and director keys), then the primary is also vulnerable to rollback and arbitrary software attacks if the supplier signs its images
| 7.     | Endless data attack |   This strategy causes an ECU to crash by sending it an indefinite amount of data, thus making it run out of storage. |1. Verify if you can respond to requests within the vehicle and able to tamper the images distributed between the primary and secondary 2. If, you are able to intercept the request then enhance the security encryption and secure the communication channel between the primary ECU and secondary ECU 3. Verify if there is additional storage (A/B storage), where it has enough storage to maintain not only a previous image, but also the latest downloaded image 4. Thus, if attackers have tampered with the image during transmission, then it may still boot to a functioning image.
| 8.   | Mix-and-match attack |    Install a malicious software bundle in which some of the updates do not interoperate properly. This may be accomplished even if all of the individual images being installed are valid, as long as valid versions exist that are mutually incompatible| This a variation to freeze attack, it is also a man-in-the-middle attack, however it restricts the updates from being installed on a few select ECU's. 1. If attackers have compromised the director keys, then the primary is also vulnerable to a mix-and-match attack, because attackers can use the director to arbitrarily combine new versions of images, and thus cause the vehicle to install incompatible versions of images. 2. Verify if the principle of least privilege is followed, as compromise of director keys could be intercepted or could be spoofed
| 9.   | Arbitrary software attack  |   Cause an ECU to install and run arbitrary code of the attacker’s choice.| This is possible if the attackers compromises the director keys, supplier keys or the primary ECU, which allows the  vehicle to install incompatible versions of images. In order to prevent it : 1. Verify the access rights to the repository keys  2. Make sure there are networking monitoring tools to detect unauthorized access.
    

